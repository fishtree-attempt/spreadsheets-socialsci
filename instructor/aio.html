<!DOCTYPE html>
<!-- START: inst/pkgdown/templates/layout.html --><!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<title>Data Organization in Spreadsheets for Social Scientists: All in One View</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" type="text/css" href="../assets/styles.css">
<script src="../assets/scripts.js" type="text/javascript"></script><!-- mathjax --><script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      config: ["MMLorHTML.js"],
      jax: ["input/TeX","input/MathML","output/HTML-CSS","output/NativeMML", "output/PreviewHTML"],
      extensions: ["tex2jax.js","mml2jax.js","MathMenu.js","MathZoom.js", "fast-preview.js", "AssistiveMML.js", "a11y/accessibility-menu.js"],
      TeX: {
        extensions: ["AMSmath.js","AMSsymbols.js","noErrors.js","noUndefined.js"]
      },
      tex2jax: {
        inlineMath: [['\\(', '\\)']],
        displayMath: [ ['$$','$$'], ['\\[', '\\]'] ],
        processEscapes: true
      }
    });
    </script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><!-- Responsive Favicon for The Carpentries --><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="manifest" href="../site.webmanifest">
<link rel="mask-icon" href="../safari-pinned-tab.svg" color="#5bbad5">
<meta name="msapplication-TileColor" content="#da532c">
<meta name="theme-color" content="#ffffff">
</head>
<body>
    <header id="top" class="navbar navbar-expand-md navbar-light bg-white top-nav data"><a class="visually-hidden-focusable skip-link" href="#main-content">Skip to main content</a>
  <div class="container-fluid top-nav-container">
    <div class="col-md-6">
      <div class="large-logo">
        <img alt="Data Carpentry" src="../assets/images/data-logo.svg">
</div>
    </div>
    <div class="selector-container">
      
      <div class="beta-alert alert alert-light alert-dismissable fade show" role="alert">
        
        
        
        <i aria-hidden="true" class="icon" data-feather="alert-circle" style="color: #5bbad5"></i>
        
        Workbench Beta |
        <a href="https://carpentries.typeform.com/to/KRBl4IZM" class="external-link alert-link" style="text-decoration: wavy overline">Give Feedback</a> |
        <a href="https://carpentries.github.io/workbench/beta-phase.html" class="external-link alert-link">Learn More</a>
        <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
      </div>
      
      
      <div class="dropdown">
        <button class="btn btn-secondary dropdown-toggle bordered-button" type="button" id="dropdownMenu1" data-bs-toggle="dropdown" aria-expanded="false">
          <i aria-hidden="true" class="icon" data-feather="eye"></i> Instructor View <i data-feather="chevron-down"></i>
        </button>
        <ul class="dropdown-menu" aria-labelledby="dropdownMenu1">
<li><button class="dropdown-item" type="button" onclick="window.location.href='../aio.html';">Learner View</button></li>
        </ul>
</div>
    </div>
  </div>
  <hr></header><nav class="navbar navbar-expand-xl navbar-light bg-white bottom-nav data" aria-label="Main Navigation"><div class="container-fluid nav-container">
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle Navigation">
      <span class="navbar-toggler-icon"></span>
      <span class="menu-title">Menu</span>
    </button>
    <div class="nav-logo">
      <img class="small-logo" alt="Data Carpentry" src="../assets/images/data-logo-sm.svg">
</div>
    <div class="lesson-title-md">
      Data Organization in Spreadsheets for Social Scientists
    </div>
    <div class="search-icon-sm">
      <!-- TODO: do not show until we have search
        <i role="img" aria-label="search button" data-feather="search"></i>
      -->
    </div>
    <div class="desktop-nav">
      <ul class="navbar-nav me-auto mb-2 mb-lg-0">
<li class="nav-item">
          <span class="lesson-title">
            Data Organization in Spreadsheets for Social Scientists
          </span>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="../instructor/key-points.html">Key Points</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="../instructor/instructor-notes.html">Instructor Notes</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="../instructor/images.html">Extract All Images</a>
        </li>
        <li class="nav-item dropdown">
          <button class="nav-link dropdown-toggle" id="navbarDropdown" data-bs-toggle="dropdown" aria-expanded="false">
            More <i data-feather="chevron-down"></i>
          </button>
          <ul class="dropdown-menu" aria-labelledby="navbarDropdown">
<hr>
<li><a class="dropdown-item" href="reference.html">Glossary</a></li>
          </ul>
</li>
      </ul>
</div>
    <form class="d-flex col-md-2 search-form">
      <fieldset disabled>
<input class="form-control me-2 searchbox" type="search" placeholder="Search" aria-label="Search"><button class="btn btn-outline-success tablet-search-button" type="submit">
          <i class="search-icon" data-feather="search" role="img" aria-label="search button"></i>
        </button>
      </fieldset>
</form>
  </div>
<!--/div.container-fluid -->
</nav><div class="col-md-12 mobile-title">
  Data Organization in Spreadsheets for Social Scientists
</div>

<aside class="col-md-12 lesson-progress"><div style="width: %" class="percentage">
    %
  </div>
  <div class="progress data">
    <div class="progress-bar data" role="progressbar" style="width: %" aria-valuenow="" aria-label="Lesson Progress" aria-valuemin="0" aria-valuemax="100">
    </div>
  </div>
</aside><div class="container">
      <div class="row">
        <!-- START: inst/pkgdown/templates/navbar.html -->
<div id="sidebar-col" class="col-lg-4">
  <div id="sidebar" class="sidebar">
      <nav aria-labelledby="flush-headingEleven"><button role="button" aria-label="close menu" alt="close menu" aria-expanded="true" aria-controls="sidebar" class="collapse-toggle" data-collapse="Collapse " data-episodes="Episodes ">
          <i class="search-icon" data-feather="x" role="img"></i>
        </button>
        <div class="sidebar-inner">
          <div class="row mobile-row">
            <div class="col">
              <div class="sidenav-view-selector">
                <div class="accordion accordion-flush" id="accordionFlush9">
                  <div class="accordion-item">
                    <h2 class="accordion-header" id="flush-headingNine">
                      <button class="accordion-button collapsed" id="instructor" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseNine" aria-expanded="false" aria-controls="flush-collapseNine">
                        <i id="eye" aria-hidden="true" class="icon" data-feather="eye"></i> Instructor View
                      </button>
                    </h2>
                    <div id="flush-collapseNine" class="accordion-collapse collapse" aria-labelledby="flush-headingNine" data-bs-parent="#accordionFlush2">
                      <div class="accordion-body">
                        <a href="../aio.html">Learner View</a>
                      </div>
                    </div>
                  </div>
<!--/div.accordion-item-->
                </div>
<!--/div.accordion-flush-->
              </div>
<!--div.sidenav-view-selector -->
            </div>
<!--/div.col -->
      
            <hr>
</div>
<!--/div.mobile-row -->

          <div class="accordion accordion-flush" id="accordionFlush11">
            <div class="accordion-item">

              <button id="chapters" class="accordion-button show" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseEleven" aria-expanded="false" aria-controls="flush-collapseEleven">
                <h2 class="accordion-header chapters" id="flush-headingEleven">
                  EPISODES
                </h2>
              </button>
              <div id="flush-collapseEleven" class="accordion-collapse show collapse" aria-labelledby="flush-headingEleven" data-bs-parent="#accordionFlush11">

                <div class="accordion-body">
                  <div class="accordion accordion-flush" id="accordionFlush1">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading1">
        <a href="index.html">Summary and Schedule</a>
    </div>
<!--/div.accordion-header-->
        
  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush2">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading2">
        <a href="00-intro.html">1. Introduction</a>
    </div>
<!--/div.accordion-header-->
        
  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush3">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading3">
        <a href="01-format-data.html">2. Formatting Data Tables in Spreadsheets</a>
    </div>
<!--/div.accordion-header-->
        
  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush4">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading4">
        <a href="02-common-mistakes.html">3. Formatting Problems</a>
    </div>
<!--/div.accordion-header-->
        
  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush5">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading5">
        <a href="03-dates-as-data.html">4. Dates as Data</a>
    </div>
<!--/div.accordion-header-->
        
  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush6">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading6">
        <a href="04-quality-assurance.html">5. Quality Assurance</a>
    </div>
<!--/div.accordion-header-->
        
  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush7">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading7">
        <a href="05-exporting-data.html">6. Exporting Data</a>
    </div>
<!--/div.accordion-header-->
        
  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

                </div>
              </div>
            </div>

            <hr class="half-width">
<div class="accordion accordion-flush resources" id="accordionFlush12">
              <div class="accordion-item">
                <h2 class="accordion-header" id="flush-headingTwelve">
                  <button class="accordion-button collapsed" id="resources" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseTwelve" aria-expanded="false" aria-controls="flush-collapseTwelve">
                    RESOURCES
                  </button>
                </h2>
                <div id="flush-collapseTwelve" class="accordion-collapse collapse" aria-labelledby="flush-headingTwelve" data-bs-parent="#accordionFlush12">
                  <div class="accordion-body">
                    <ul>
<li>
                        <a href="../instructor/key-points.html">Key Points</a>
                      </li>
                      <li>
                        <a href="../instructor/instructor-notes.html">Instructor Notes</a>
                      </li>
                      <li>
                        <a href="../instructor/images.html">Extract All Images</a>
                      </li>
                      <hr>
<li><a class="dropdown-item" href="reference.html">Glossary</a></li>
                    </ul>
</div>
                </div>
              </div>
            </div>
            <hr class="half-width resources">
<a href="../instructor/aio.html">See all in one page</a>
            

            <hr class="d-none d-sm-block d-md-none">
<div class="d-grid gap-1">
            
            </div>
          </div>
<!-- /div.accordion -->
        </div>
<!-- /div.sidebar-inner -->
      </nav>
</div>
<!-- /div.sidebar -->
  </div>
<!-- /div.sidebar-col -->
<!-- END:   inst/pkgdown/templates/navbar.html-->

        <!-- START: inst/pkgdown/templates/content-extra.html -->
  <div class="col-xl-8 col-lg-12 primary-content">
    <main id="main-content" class="main-content"><div class="container lesson-content">
        
        
<section id="aio-00-intro"><p>Content from <a href="00-intro.html">Introduction</a></p>
<hr>
<p>Last updated on 2023-05-03 |
        
        <a href="https://github.com/fishtree-attempt/spreadsheets-socialsci/edit/main/episodes/00-intro.md" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<p>Estimated time: <i aria-hidden="true" data-feather="clock"></i> 18 minutes</p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>What are basic principles for using spreadsheets for good data
organization?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Understand how to organize data so computers can make the best use
of the data</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div id="things-youll-need-to-complete-this-tutorial" class="callout prereq">
<div class="callout-square">
<i class="callout-icon" data-feather="check"></i>
</div>
<div id="things-youll-need-to-complete-this-tutorial" class="callout-inner">
<h3 class="callout-title">Things You’ll Need To Complete This
Tutorial<a class="anchor" aria-label="anchor" href="#things-youll-need-to-complete-this-tutorial"></a>
</h3>
<div class="section level4 callout-content">
<h4 id="spreadsheet-software">Spreadsheet Software<a class="anchor" aria-label="anchor" href="#spreadsheet-software"></a>
</h4>
<p>To work through this tutorial you will need access to a spreadsheet
program. Many computers come with a pre-installed spreadsheet program
like Excel. macOS users who use Apple’s Numbers application should note
that it does not contain some of the features (particularly data
validation) that we will be using. Please use LibreOffice or Microsoft
Excel instead.</p>
<p>If you do not have a spreadsheet program, install one using the
instructions in the link below.</p>
<ul>
<li><a href="index.html#setup">Instructions to install a spreadsheet
program.</a></li>
</ul>
</div>
</div>
</div>
<p>Good data organization is the foundation of your research project.
Most researchers have data or do data entry in spreadsheets. Spreadsheet
programs are very useful graphical interfaces for designing data tables
and handling very basic data quality control functions.</p>
<div class="section level3">
<h3 id="spreadsheet-outline">Spreadsheet outline<a class="anchor" aria-label="anchor" href="#spreadsheet-outline"></a>
</h3>
<p>In this lesson, we’re going to talk about:</p>
<ul>
<li>Good data entry practices - formatting data tables in
spreadsheets</li>
<li>How to avoid common formatting mistakes</li>
<li>Recognising and reformatting dates in spreadsheets</li>
<li>Basic quality control and data manipulation in spreadsheets</li>
<li>Exporting data from spreadsheets</li>
</ul>
</div>
<div class="section level3">
<h3 id="spreadsheet-programs">Spreadsheet programs<a class="anchor" aria-label="anchor" href="#spreadsheet-programs"></a>
</h3>
<p>Many spreadsheet programs are available. We will use Microsoft Excel
in our examples. Although it is not open source software it is very
widely available and used.</p>
<p>Free spreadsheet programs such as LibreOffice are available. The
functionality of these may differ from Excel, but in general they can be
used to perform similar tasks.</p>
</div>
<section id="problems-with-spreadsheets"><h2 class="section-heading">Problems with Spreadsheets<a class="anchor" aria-label="anchor" href="#problems-with-spreadsheets"></a>
</h2>
<hr class="half-width">
<p>Spreadsheets are good for data entry, but in reality we tend to use
spreadsheet programs for much more than data entry. We use them to
create data tables for publications, to generate summary statistics, and
make figures. Laying out spreadsheets in this way often adds some
difficulty when we want to take our data from the spreadsheet and use it
in another program. Additional white space, merged cells, colour and
grids may aid readability but are not easily handled by other programs
that take our spreadsheet as an input to further analysis.</p>
<p>Generating statistics and figures in spreadsheets should be done with
caution. The graphical, drag and drop nature of spreadsheet programs
means that it can be very difficult, if not impossible, to replicate
your steps (much less retrace anyone else’s). This is particularly true
if your stats or figures require complex calculations. Furthermore, when
performing calculations in a spreadsheet, it’s easy to accidentally
apply a slightly different formula to multiple adjacent cells. This
often makes it difficult to demonstrate data quality and consistency in
our analysis.</p>
<p>Even when we are aware of some of the limitations that data in
spreadsheets presents, often we have inherited spreadsheets from another
colleague or data provider. In these situations we cannot exercise any
control in its construction or entry of the data within it. Nevertheless
it is important to be aware of the limitations these data may present,
and know how to assess if any problems are present and how to overcome
them.</p>
<div id="what-this-lesson-will-not-teach-you" class="callout callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="what-this-lesson-will-not-teach-you" class="callout-inner">
<h3 class="callout-title">What this lesson will not teach you<a class="anchor" aria-label="anchor" href="#what-this-lesson-will-not-teach-you"></a>
</h3>
<div class="callout-content">
<ul>
<li>How to do <em>statistics</em> in a spreadsheet</li>
<li>How to do <em>plotting</em> in a spreadsheet</li>
<li>How to <em>write code</em> in spreadsheet programs</li>
</ul>
<p>If you’re looking to do this, a good reference is <a href="https://www.amazon.com/Head-First-Excel-learners-spreadsheets/dp/0596807694/ref=sr_1_1?ie=UTF8&amp;qid=1491594584&amp;sr=8-1&amp;keywords=head+first+excel" class="external-link">Head
First Excel</a>, published by O’Reilly.</p>
</div>
</div>
</div>
<div id="exercise" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="exercise" class="callout-inner">
<h3 class="callout-title">Exercise<a class="anchor" aria-label="anchor" href="#exercise"></a>
</h3>
<div class="callout-content">
<ul>
<li>How many people have used spreadsheets in their research?</li>
<li>How many people have accidentally done something that made them
frustrated or sad?</li>
</ul>
</div>
</div>
</div>
<div class="section level3">
<h3 id="using-spreadsheets-for-data-entry-and-cleaning">Using Spreadsheets for Data Entry and Cleaning<a class="anchor" aria-label="anchor" href="#using-spreadsheets-for-data-entry-and-cleaning"></a>
</h3>
<p>However, there are circumstances where you might want to use a
spreadsheet program to produce “quick and dirty” calculations or
figures, and some of these features can be used in data cleaning, prior
to importation into a statistical analysis program. We will show you how
to use some features of spreadsheet programs to check your data quality
along the way and produce preliminary summary statistics.</p>
<p>In this lesson, we will assume that you are most likely using Excel
as your primary spreadsheet program - there are other programs with
similar functionality but Excel seems to be the most commonly used.</p>
<p>In this lesson we’re going to talk about:</p>
<ol style="list-style-type: decimal">
<li><a href="01-format-data.html">Formatting data tables in
spreadsheets</a></li>
<li><a href="02-common-mistakes.html">Formatting problems</a></li>
<li><a href="03-dates-as-data.html">Dates as data</a></li>
<li><a href="04-quality-assurance.html">Quality control</a></li>
<li><a href="05-exporting-data.html">Exporting data</a></li>
</ol>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Key Points<a class="anchor" aria-label="anchor" href="#keypoints1"></a>
</h3>
<div class="callout-content">
<ul>
<li>Organizing your data tables according to tidy data principles will
make them easier for you and others to use for analysis.</li>
</ul>
</div>
</div>
</div>
</div>
</section></section><section id="aio-01-format-data"><p>Content from <a href="01-format-data.html">Formatting Data Tables in Spreadsheets</a></p>
<hr>
<p>Last updated on 2023-05-03 |
        
        <a href="https://github.com/fishtree-attempt/spreadsheets-socialsci/edit/main/episodes/01-format-data.md" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<p>Estimated time: <i aria-hidden="true" data-feather="clock"></i> 30 minutes</p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>What are some common challenges with formatting data in spreadsheets
and how can we avoid them?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Recognise and resolve common spreadsheet formatting problems.</li>
<li>Describe the importance of metadata.</li>
<li>Identify metadata that should be included with a dataset.</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<section id="data-formatting-problems"><h2 class="section-heading">Data formatting problems<a class="anchor" aria-label="anchor" href="#data-formatting-problems"></a>
</h2>
<hr class="half-width">
<p>The most common mistake made is treating spreadsheet programs like
lab notebooks, that is, relying on context, notes in the margin, spatial
layout of data and fields to convey information. As humans, we can
(usually) interpret these things, but computers don’t view information
the same way, and unless we explain to the computer what every single
thing means (and that can be hard!), it will not be able to see how our
data fit together.</p>
<p>Using the power of computers, we can manage and analyze data in much
more effective and faster ways, but to use that power, we have to set up
our data for the computer to be able to understand it (and computers are
very literal).</p>
<p>This is why it’s extremely important to set up well-formatted tables
from the outset - before you even start entering data from your very
first preliminary experiment. Data organization is the foundation of
your research project. It can make it easier or harder to work with your
data throughout your analysis, so it’s worth thinking about when you’re
doing your data entry or setting up your experiment. You can set things
up in different ways in spreadsheets, but some of these choices can
limit your ability to work with the data in other programs or have the
you-of-6-months-from-now or your collaborator work with the data.</p>
<div id="tip" class="callout callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="tip" class="callout-inner">
<h3 class="callout-title">Tip<a class="anchor" aria-label="anchor" href="#tip"></a>
</h3>
<div class="callout-content">
<p>The best layouts/formats (as well as software and interfaces) for
data entry and data analysis might be different. It is important to take
this into account, and ideally automate the conversion from one to
another.</p>
</div>
</div>
</div>
<div class="section level3">
<h3 id="keeping-track-of-your-analyses">Keeping track of your analyses<a class="anchor" aria-label="anchor" href="#keeping-track-of-your-analyses"></a>
</h3>
<p>When you’re working with spreadsheets, during data clean up or
analyses, it’s very easy to end up with a spreadsheet that looks very
different from the one you started with. In order to be able to
reproduce your analyses or figure out what you did when Reviewer #3 asks
for a different analysis, you should</p>
<ul>
<li>create a new file or tab with your cleaned or analyzed data. Don’t
modify the original dataset, or you will never know where you
started!</li>
<li>keep track of the steps you took in your clean up or analysis. You
should track these steps as you would any step in an experiment. You can
do this in another text file, or a good option is to create a new tab in
your spreadsheet with your notes. This way the notes and data stay
together.</li>
</ul>
<p>Put these principles in to practice today during the exercises.</p>
</div>
<div class="section level3">
<h3 id="structuring-data-in-spreadsheets">Structuring data in spreadsheets<a class="anchor" aria-label="anchor" href="#structuring-data-in-spreadsheets"></a>
</h3>
<p>The cardinal rules of using spreadsheet programs for data:</p>
<ol style="list-style-type: decimal">
<li>Put all your variables in columns - the thing you’re measuring, like
‘weight’ or ‘temperature’.</li>
<li>Put each observation in its own row.</li>
<li>Don’t combine multiple pieces of information in one cell. Sometimes
it just seems like one thing, but think if that’s the only way you’ll
want to be able to use or sort that data.</li>
<li>Leave the raw data raw - don’t change it!</li>
<li>Export the cleaned data to a text-based format like CSV
(comma-separated values) format. This ensures that anyone can use the
data, and is required by most data repositories.</li>
</ol>
<p>For instance, we’re going to be working with data from a study of
agricultural practices among farmers in two countries in eastern
sub-Saharan Africa (Mozambique and Tanzania). Researchers conducted
interviews with farmers in these countries to collect data on household
statistics (e.g. number of household members, number of meals eaten per
day, availability of water), farming practices (e.g. water usage), and
assets (e.g. number of farm plots, number of livestock). They also
recorded the dates and locations of each interview.</p>
<p>If they were to keep track of the data like this:</p>
<figure><img src="../fig/multiple-info.png" alt="multiple-info example" class="figure mx-auto d-block"></figure><p>the problem is that number of livestock and type of livestock are in
the same field. So, if they wanted to look at the average number of
livestock owned, or the average number of each type of livestock, it
would be hard to do this using this data setup. If instead we put the
count of each type of livestock in its own column, this would make
analysis much easier. The rule of thumb, when setting up a datasheet, is
that each variable (in this case, each type of livestock) should have
its own column, each observation should have its own row, and each cell
should contain only a single value. Thus, the example above should look
like this:</p>
<figure><img src="../fig/single-info.png" alt="single-info example" class="figure mx-auto d-block"></figure><p>Notice that this now allows us to make statements about the number of
each type of animal that a farmer owns, while still allowing us to say
things about the total number of livestock. All we need to do is sum the
values in each row to find a total. We’ll be learning how to do this
computationally and reproducibly later in this workshop.</p>
<div id="workshop-data" class="callout callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="workshop-data" class="callout-inner">
<h3 class="callout-title">Workshop Data<a class="anchor" aria-label="anchor" href="#workshop-data"></a>
</h3>
<div class="callout-content">
<blockquote>
<p>The data used in these lessons are taken from interviews of farmers
in two countries in eastern sub-Saharan Africa (Mozambique and
Tanzania). These interviews were conducted between November 2016 and
June 2017 and probed household features (e.g. construction materials
used, number of household members), agricultural practices (e.g. water
usage), and assets (e.g. number and types of livestock).</p>
</blockquote>
<p>This is a real dataset, however, it has been simplified for this
workshop. If you’re interested in exploring the full dataset further,
you can download it from Figshare and work with it using exactly the
same tools we’ll learn about today.</p>
<p>For more information about the dataset and to download it from
Figshare, check out the <a href="https://www.datacarpentry.org/socialsci-workshop/data" class="external-link">Social
Sciences workshop data page</a>.</p>
</div>
</div>
</div>
<div id="libreoffice-users" class="callout callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="libreoffice-users" class="callout-inner">
<h3 class="callout-title">LibreOffice Users<a class="anchor" aria-label="anchor" href="#libreoffice-users"></a>
</h3>
<div class="callout-content">
<p>The default for LibreOffice is to treat tabs, commas, and semicolons
as delimiters. This behavior can cause problems with both the data for
this lesson and other data you might want to use. This can be fixed when
opening LibreOffice by deselecting the “semicolons” and “tabs”
checkboxes.</p>
</div>
</div>
</div>
<div id="exercise" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="exercise" class="callout-inner">
<h3 class="callout-title">Exercise<a class="anchor" aria-label="anchor" href="#exercise"></a>
</h3>
<div class="callout-content">
<p>We’re going to take a messy version of the SAFI data and describe how
we would clean it up.</p>
<ol style="list-style-type: decimal">
<li>Download the <a href="https://ndownloader.figshare.com/files/11502824" class="external-link">messy
data</a>.</li>
<li>Open up the data in a spreadsheet program.</li>
<li>Notice that there are two tabs. Two researchers conducted the
interviews, one in Mozambique and the other in Tanzania. They both
structured their data tables in a different way. Now, you’re the person
in charge of this project and you want to be able to start analyzing the
data.</li>
<li>With the person next to you, identify what is wrong with this
spreadsheet. Discuss the steps you would need to take to clean up the
two tabs, and to put them all together in one spreadsheet.</li>
</ol>
<p><strong>Important</strong> Do not forget our first piece of advice,
to create a new file (or tab) for the cleaned data, never modify your
original (raw) data.</p>
<p>After you go through this exercise, we’ll discuss as a group what was
wrong with this data and how you would fix it.</p>
</div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1">Show me the solution</h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" data-bs-parent="#accordionSolution1" aria-labelledby="headingSolution1">
<div class="accordion-body">
<ul>
<li>Take about 10 minutes to work on this exercise.</li>
<li>All the mistakes listed in <a href="02-common-mistakes.html">the
next episode</a> are present in the messy dataset. If this exercise is
done during a workshop, ask people what they saw as wrong with the data.
As they bring up different points, you can refer to <a href="02-common-mistakes.html">the next episode</a> or expand a bit on
the point they brought up.</li>
</ul>
</div>
</div>
</div>
</div>
<div id="handy-references" class="callout callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="handy-references" class="callout-inner">
<h3 class="callout-title">Handy References<a class="anchor" aria-label="anchor" href="#handy-references"></a>
</h3>
<div class="callout-content">
<p>Two excellent references on spreadsheet organization are:</p>
<ul>
<li><p>Karl W. Broman &amp; Kara H. Woo, <em>Data Organization in
Spreadsheets</em>, Vol. 72, Issue 1, 2018, The American Statistician. <a href="https://www.tandfonline.com/doi/full/10.1080/00031305.2017.1375989" class="external-link">https://www.tandfonline.com/doi/full/10.1080/00031305.2017.1375989</a></p></li>
<li><p>Hadley Wickham, <em>Tidy Data</em>, Vol. 59, Issue 10, Sep 2014,
Journal of Statistical Software. <a href="https://www.jstatsoft.org/v59/i10" class="external-link">http://www.jstatsoft.org/v59/i10</a></p></li>
</ul>
</div>
</div>
</div>
</div>
<div class="section level3">
<h3 id="metadata">Metadata<a class="anchor" aria-label="anchor" href="#metadata"></a>
</h3>
<p>Recording data about your data (“metadata”) is essential. You may be
on intimate terms with your dataset while you are collecting and
analysing it, but the chances that you will still remember the exact
wording of the question you asked about your informants’ water use (the
data recorded in the column <code>water use</code>), for example, are
slim.</p>
<p>As well, there are many reasons other people may want to examine or
use your data - to understand your findings, to verify your findings, to
review your submitted publication, to replicate your results, to design
a similar study, or even to archive your data for access and re-use by
others. While digital data by definition are machine-readable,
understanding their meaning is a job for human beings. The importance of
documenting your data during the collection and analysis phase of your
research cannot be overestimated, especially if your research is going
to be part of the scholarly record.</p>
<p>However, metadata should not be contained in the data file itself.
Unlike a table in a paper or a supplemental file, metadata (in the form
of legends) should not be included in a data file since this information
is not data, and including it can disrupt how computer programs
interpret your data file. Rather, metadata should be stored as a
separate file in the same directory as your data file, preferably in
plain text format with a name that clearly associates it with your data
file. Because metadata files are free text format, they also allow you
to encode comments, units, information about how null values are
encoded, etc. that are important to document but can disrupt the
formatting of your data file.</p>
<p>Some of this information may be familiar to learners who conduct
analyses on survey data or other data sets that come with codebooks.
Codebooks will often describe the way a variable has been constructed,
what prompt was associated with it in an survey or interview, and what
the meaning of various values are. For example, the <a href="https://gss.norc.org" class="external-link">General Social Survey</a> maintains their
entire codebook online. Looking at an entry for a particular variable,
such as <a href="https://gssdataexplorer.norc.org/variables/81/vshow" class="external-link">the variable
<code>SEX</code></a>, provides valuable information about what survey
waves the variable covers, and the meaning of particular values.</p>
<p>Additionally, file or database level metadata describes how files
that make up the dataset relate to each other; what format are they are
in; and whether they supersede or are superseded by previous files. A
folder-level readme.txt file is the classic way of accounting for all
the files and folders in a project.</p>
<p>Metadata are most useful when they follow a standard. For example,
the <a href="https://www.ddialliance.org" class="external-link">Data Documentation Initiative
(DDI)</a> provides a standardized way to document metadata at various
points in the research cycle. Research librarians may have specific
expertise in this area, and can be helpful resources for thinking about
ways to purposefully document metatdata as part of your research.</p>
<p>(Text on metadata adapted from the online course Research Data <a href="https://datalib.edina.ac.uk/mantra" class="external-link">MANTRA</a> by EDINA and Data
Library, University of Edinburgh. MANTRA is licensed under a <a href="https://creativecommons.org/licenses/by/4.0/" class="external-link">Creative Commons
Attribution 4.0 International License</a>.)</p>
<div id="exercise-1" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="exercise-1" class="callout-inner">
<h3 class="callout-title">Exercise<a class="anchor" aria-label="anchor" href="#exercise-1"></a>
</h3>
<div class="callout-content">
<p>Download a <a href="https://ndownloader.figshare.com/files/11492171" class="external-link">clean version of
this dataset</a> and open the file with your spreadsheet program. This
data has many more variables that were not included in the messy
spreadsheet and is formatted according to tidy data principles.</p>
<p>Discuss this data with a partner and make a list of some of the types
of metadata that should be recorded about this dataset. It may be
helpful to start by asking yourself, “What is not immediately obvious to
me about this data? What questions would I need to know the answers to
in order to analyze and interpret this data?”</p>
</div>
</div>
</div>
<div id="accordionSolution2" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution2" aria-expanded="false" aria-controls="collapseSolution2">
  <h4 class="accordion-header" id="headingSolution2">Show me the solution</h4>
</button>
<div id="collapseSolution2" class="accordion-collapse collapse" data-bs-parent="#accordionSolution2" aria-labelledby="headingSolution2">
<div class="accordion-body">
<p>Some types of metadata that should be recorded and made available
with the data are:</p>
<ul>
<li>the exact wording of questions used in the interviews (if interviews
were structured) or general prompts used (if interviews were
semi-structured)</li>
<li>a description of the type of data allowed in each column (e.g. the
allowed range for numerical data with a restricted range, a list of
allowed options for categorical variables, whether data in a numerical
column should be continuous or discrete)</li>
<li>definitions of any categorical variables (e.g. definitions of
“burntbricks” and “sunbricks”)</li>
<li>definitions of what was counted as a “room”, a “plot”, etc.
(e.g. was there a minimum size)</li>
<li>learners may come up with additional questions to add to this
list</li>
</ul>
</div>
</div>
</div>
</div>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Key Points<a class="anchor" aria-label="anchor" href="#keypoints1"></a>
</h3>
<div class="callout-content">
<ul>
<li>Never modify your raw data. Always make a copy before making any
changes.</li>
<li>Keep track of all of the steps you take to clean your data.</li>
<li>Organize your data according to tidy data principles.</li>
<li>Record metadata in a separate plain text file.</li>
</ul>
</div>
</div>
</div>
</div>
</section></section><section id="aio-02-common-mistakes"><p>Content from <a href="02-common-mistakes.html">Formatting Problems</a></p>
<hr>
<p>Last updated on 2023-05-03 |
        
        <a href="https://github.com/fishtree-attempt/spreadsheets-socialsci/edit/main/episodes/02-common-mistakes.md" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<p>Estimated time: <i aria-hidden="true" data-feather="clock"></i> 20 minutes</p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>What are some common challenges with formatting data in spreadsheets
and how can we avoid them?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Recognize and resolve common spreadsheet formatting problems.</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<section id="common-spreadsheet-errors"><h2 class="section-heading">Common Spreadsheet Errors<a class="anchor" aria-label="anchor" href="#common-spreadsheet-errors"></a>
</h2>
<hr class="half-width">
<p>This lesson is meant to be used as a reference for discussion as
learners identify issues with the messy dataset discussed in the
previous lesson. Instructors: don’t go through this lesson except to
refer to responses to the exercise in the previous lesson.</p>
<p>There are a few potential errors to be on the lookout for in your own
data as well as data from collaborators or the Internet. If you are
aware of the errors and the possible negative effect on downstream data
analysis and result interpretation, it might motivate yourself and your
project members to try and avoid them. Making small changes to the way
you format your data in spreadsheets, can have a great impact on
efficiency and reliability when it comes to data cleaning and
analysis.</p>
<ul>
<li><a href="#tables">Using multiple tables</a></li>
<li><a href="#tabs">Using multiple tabs</a></li>
<li><a href="#zeros">Not filling in zeros</a></li>
<li><a href="#null">Using problematic null values</a></li>
<li><a href="#formatting">Using formatting to convey
information</a></li>
<li><a href="#formatting-pretty">Using formatting to make the data sheet
look pretty</a></li>
<li><a href="#units">Placing comments or units in cells</a></li>
<li><a href="#info">Entering more than one piece of information in a
cell</a></li>
<li><a href="#field-name">Using problematic field names</a></li>
<li><a href="#special">Using special characters in data</a></li>
</ul></section><section id="tables"><h2 class="section-heading">Using multiple tables<a class="anchor" aria-label="anchor" href="#tables"></a>
</h2>
<hr class="half-width">
<p>A common strategy is creating multiple data tables within one
spreadsheet. This confuses the computer, so don’t do this! When you
create multiple tables within one spreadsheet, you’re drawing false
associations between things for the computer, which sees each row as an
observation. You’re also potentially using the same field name in
multiple places, which will make it harder to clean your data up into a
usable form. The example below depicts the problem:</p>
<figure><img src="../fig/multiple-tables-example2.png" alt="multiple tables" class="figure mx-auto d-block"></figure><p>In the example above, the computer will see (for example) row 24 and
assume that all columns A-J refer to the same sample. This row actually
represents two distinct samples (information about livestock for
informant 1 and information about plots for informant 2). Other rows are
similarly problematic.</p>
</section><section id="tabs"><h2 class="section-heading">Using multiple tabs<a class="anchor" aria-label="anchor" href="#tabs"></a>
</h2>
<hr class="half-width">
<p>But what about workbook tabs? That seems like an easy way to organize
data, right? Well, yes and no. When you create extra tabs, you fail to
allow the computer to see connections in the data that are there (you
have to introduce spreadsheet application-specific functions or
scripting to ensure this connection). Say, for instance, you make a
separate tab for each day you take a measurement.</p>
<p>This isn’t good practice for two reasons:</p>
<ol style="list-style-type: decimal">
<li>you are more likely to accidentally add inconsistencies to your data
if each time you take a measurement, you start recording data in a new
tab, and</li>
<li>even if you manage to prevent all inconsistencies from creeping in,
you will add an extra step for yourself before you analyze the data
because you will have to combine these data into a single datatable. You
will have to explicitly tell the computer how to combine tabs - and if
the tabs are inconsistently formatted, you might even have to do it
manually.</li>
</ol>
<p>For these and other reasons, it is good practice to avoid creating
new tabs to organize your spreadsheet data. The next time you’re
entering data, and you go to create another tab or table, ask yourself
if you could avoid adding this tab by adding another column to your
original spreadsheet. You may, however, use a new tab to store notes
about your data, such as steps you’ve taken to clean or manipulate your
data.</p>
<p>Your data sheet might get very long over the course of the
experiment. This makes it harder to enter data if you can’t see your
headers at the top of the spreadsheet. But don’t repeat your header row.
These can easily get mixed into the data, leading to problems down the
road.</p>
<p>Instead you can freeze the column headers so that they remain visible
even when you have a spreadsheet with many rows.</p>
<p><a href="https://support.office.com/en-ca/article/Freeze-column-headings-for-easy-scrolling-57ccce0c-cf85-4725-9579-c5d13106ca6a" class="external-link">Documentation
on how to freeze column headers</a></p>
</section><section id="zeros"><h2 class="section-heading">Not filling in zeros<a class="anchor" aria-label="anchor" href="#zeros"></a>
</h2>
<hr class="half-width">
<p>It might be that when you’re measuring something, it’s usually a
zero, say the number of cows that an informant has, in a region where
most farmers have goats and no cows. Why bother writing in the number
zero in that column, when it’s mostly zeros?</p>
<figure><img src="../fig/zeros-example.png" alt="filling in zeros" class="figure mx-auto d-block"></figure><p>However, there’s a difference between a zero and a blank cell in a
spreadsheet. To the computer, a zero is actually data. You measured or
counted it. A blank cell means that it wasn’t measured and the computer
will interpret it as an unknown value (otherwise known as a null
value).</p>
<p>The spreadsheets or statistical programs will likely mis-interpret
blank cells that you intend to be zeros. By not entering the value of
your observation, you are telling your computer to represent that data
as unknown or missing (null). This can cause problems with subsequent
calculations or analyses. For example, the average of a set of numbers
which includes a single null value is always null (because the computer
can’t guess the value of the missing observations). Because of this,
it’s very important to record zeros as zeros and truly missing data as
nulls.</p>
</section><section id="null"><h2 class="section-heading">Using problematic null values<a class="anchor" aria-label="anchor" href="#null"></a>
</h2>
<hr class="half-width">
<p><strong>Example</strong>: using -999 or other numerical values (or
zero) to represent missing data.</p>
<p><strong>Solution</strong>: One common practice is to record unknown
or missing data as -999, 999, or 0. Many statistical programs will not
recognize that these are intended to represent missing (null) values.
How these values are interpreted will depend on the software you use to
analyze your data. It is essential to use a clearly defined and
consistent null indicator. Blanks (most applications) and NA (for R) are
good choices. White et al, 2013, explain good choices for indicating
null values for different software applications in their article: <a href="https://ojs.library.queensu.ca/index.php/IEE/article/view/4608" class="external-link">Nine
simple ways to make it easier to (re)use your data.</a> Ideas in Ecology
and Evolution.</p>
<table class="table">
<colgroup>
<col width="5%">
<col width="78%">
<col width="9%">
<col width="6%">
</colgroup>
<thead><tr class="header">
<th>Null Values</th>
<th>Problems</th>
<th>Compatibility</th>
<th>Recommendation</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>0</td>
<td>Indistinguishable from a true zero</td>
<td></td>
<td>NEVER use</td>
</tr>
<tr class="even">
<td>Blank</td>
<td>Hard to distinguish values that are missing from those overlooked on
entry. Hard to distinguish blanks from spaces, which behave
differently.</td>
<td>R, Python, SQL, Excel</td>
<td>Best option</td>
</tr>
<tr class="odd">
<td>-999, 999</td>
<td>Not recognized as null by many programs without user input. Can be
inadvertently entered into calculations.</td>
<td></td>
<td>Avoid</td>
</tr>
<tr class="even">
<td>NA, na</td>
<td>Can also be an abbreviation (e.g., North America), can cause
problems with data type (turn a numerical column into a text column). NA
is more commonly recognized than na.</td>
<td>R</td>
<td>Good option</td>
</tr>
<tr class="odd">
<td>N/A</td>
<td>An alternate form of NA, but often not compatible with
software.</td>
<td></td>
<td>Avoid</td>
</tr>
<tr class="even">
<td>NULL</td>
<td>Can cause problems with data type.</td>
<td>SQL</td>
<td>Good option</td>
</tr>
<tr class="odd">
<td>None</td>
<td>Uncommon. Can cause problems with data type.</td>
<td>Python</td>
<td>Avoid</td>
</tr>
<tr class="even">
<td>No data</td>
<td>Uncommon. Can cause problems with data type, contains a space.</td>
<td></td>
<td>Avoid</td>
</tr>
<tr class="odd">
<td>Missing</td>
<td>Uncommon. Can cause problems with data type.</td>
<td></td>
<td>Avoid</td>
</tr>
<tr class="even">
<td>-, +, .</td>
<td>Uncommon. Can cause problems with data type.</td>
<td></td>
<td>Avoid</td>
</tr>
</tbody>
</table></section><section id="formatting"><h2 class="section-heading">Using formatting to convey information<a class="anchor" aria-label="anchor" href="#formatting"></a>
</h2>
<hr class="half-width">
<p><strong>Example</strong>: highlighting cells, rows or columns that
should be excluded from an analysis, leaving blank rows to indicate
separations in data.</p>
<figure><img src="../fig/bad-formatting.png" alt="formatting" class="figure mx-auto d-block"></figure><p><strong>Solution</strong>: create a new field to encode which data
should be excluded.</p>
<figure><img src="../fig/better-formatting.png" alt="good formatting" class="figure mx-auto d-block"></figure></section><section id="using-formatting-to-make-the-data-sheet-look-pretty-formatting-pretty"><h2 class="section-heading">Using formatting to make the data sheet look pretty
{#formatting-pretty}<a class="anchor" aria-label="anchor" href="#using-formatting-to-make-the-data-sheet-look-pretty-formatting-pretty"></a>
</h2>
<hr class="half-width">
<p><strong>Example</strong>: merging cells.</p>
<p><strong>Solution</strong>: If you’re not careful, formatting a
worksheet to be more aesthetically pleasing can compromise your
computer’s ability to see associations in the data. Merged cells will
make your data unreadable by statistics software. Consider restructuring
your data in such a way that you will not need to merge cells to
organize your data.</p>
</section><section id="units"><h2 class="section-heading">Placing comments or units in cells<a class="anchor" aria-label="anchor" href="#units"></a>
</h2>
<hr class="half-width">
<p><strong>Example</strong>: Some of your informants only irrigate their
plots at certain times of the year. You’ve added this information as
notes directly into the cell with the data.</p>
<p><strong>Solution</strong>: Most analysis software can’t see Excel or
LibreOffice comments, and would be confused by comments placed within
your data cells. As described above for formatting, create another field
if you need to add notes to cells. Similarly, don’t include units in
cells: ideally, all the measurements you place in one column should be
in the same unit, but if for some reason they aren’t, create another
field and specify the units the cell is in.</p>
<figure><img src="../fig/comments-in-cells.png" alt="comments in cells" class="figure mx-auto d-block"></figure></section><section id="info"><h2 class="section-heading">Entering more than one piece of information in a cell<a class="anchor" aria-label="anchor" href="#info"></a>
</h2>
<hr class="half-width">
<p><strong>Example</strong>: Your informant has multiple livestock of
different types. You record this information as “3, (oxen , cows)” to
indicate that there are three total livestock, which is a mixture of
oxen and cows.</p>
<p><strong>Solution</strong>: Don’t include more than one piece of
information in a cell. This will limit the ways in which you can analyze
your data. If you need both these types of information (the total number
of animals and the types), design your data sheet to include this
information. For example, include a separate column for each type of
livestock.</p>
</section><section id="using-problematic-field-names-field-name"><h2 class="section-heading">Using problematic field names {#field-name}<a class="anchor" aria-label="anchor" href="#using-problematic-field-names-field-name"></a>
</h2>
<hr class="half-width">
<p>Choose descriptive field names, but be careful not to include spaces,
numbers, or special characters of any kind. Spaces can be misinterpreted
by parsers that use whitespace as delimiters and some programs don’t
like field names that are text strings that start with numbers.</p>
<p>Underscores (<code>_</code>) are a good alternative to spaces.
Consider writing names in camel case (like this: ExampleFileName) to
improve readability. Remember that abbreviations that make sense at the
moment may not be so obvious in 6 months, but don’t overdo it with names
that are excessively long. Including the units in the field names avoids
confusion and enables others to readily interpret your variable names.
Avoid starting variable names with numbers, as this may cause problems
with some analysis software.</p>
<p><strong>Examples</strong></p>
<table align="left" style="width =50%; border: 1px solid black;" class="table">
<tr>
<td>
<b>Good Name</b>
</td>
<br><td>
<b>Good Alternative </b>
</td>
<br><td>
<b>Avoid </b>
</td>
<br>
</tr>
<tr>
<td>
wall_type
</td>
<td>
WallType
</td>
<td>
wall type
</td>
</tr>
<tr>
<td>
longitude
</td>
<td>
GpsLongitude
</td>
<td>
gps:Longitude
</td>
</tr>
<tr>
<td>
gender
</td>
<td>
gender
</td>
<td>
M/F
</td>
</tr>
<tr>
<td>
Informant_01
</td>
<td>
first_informant
</td>
<td>
1st Inf
</td>
</tr>
<tr>
<td>
age_18
</td>
<td>
years18
</td>
<td>
18years
</td>
</tr>
</table></section><section id="special"><h2 class="section-heading">Using special characters in data<a class="anchor" aria-label="anchor" href="#special"></a>
</h2>
<hr class="half-width">
<p><strong>Example</strong>: You treat your spreadsheet program as a
word processor when writing notes, for example copying data directly
from Word or other applications.</p>
<p><strong>Solution</strong>: This is a common strategy. For example,
when writing longer text in a cell, people often include line breaks,
em-dashes, etc in their spreadsheet. Also, when copying data in from
applications such as Word, formatting and fancy non-standard characters
(such as left- and right-aligned quotation marks) are included. When
exporting this data into a coding/statistical environment or into a
relational database, dangerous things may occur, such as lines being cut
in half and encoding errors being thrown.</p>
<p>General best practice is to avoid adding characters such as newlines,
tabs, and vertical tabs. In other words, treat a text cell as if it were
a simple web form that can only contain text and spaces.</p>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Key Points<a class="anchor" aria-label="anchor" href="#keypoints1"></a>
</h3>
<div class="callout-content">
<ul>
<li>Avoid using multiple tables within one spreadsheet.</li>
<li>Avoid spreading data across multiple tabs (but do use a new tab to
record data cleaning or manipulations).</li>
<li>Record zeros as zeros.</li>
<li>Use an appropriate null value to record missing data.</li>
<li>Don’t use formatting to convey information or to make your
spreadsheet look pretty.</li>
<li>Place comments in a separate column.</li>
<li>Record units in column headers.</li>
<li>Include only one piece of information in a cell.</li>
<li>Avoid spaces, numbers and special characters in column headers.</li>
<li>Avoid special characters in your data.</li>
</ul>
</div>
</div>
</div>
</section></section><section id="aio-03-dates-as-data"><p>Content from <a href="03-dates-as-data.html">Dates as Data</a></p>
<hr>
<p>Last updated on 2023-05-03 |
        
        <a href="https://github.com/fishtree-attempt/spreadsheets-socialsci/edit/main/episodes/03-dates-as-data.md" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<p>Estimated time: <i aria-hidden="true" data-feather="clock"></i> 20 minutes</p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>What are good approaches for handling dates in spreadsheets?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Recognise problematic or suspicious date formats.</li>
<li>Use formulas to separate dates into their component values
(e.g. Month, Day, Year).</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<section id="date-formats-in-spreadsheets"><h2 class="section-heading">Date formats in spreadsheets<a class="anchor" aria-label="anchor" href="#date-formats-in-spreadsheets"></a>
</h2>
<hr class="half-width">
<p>Dates in spreadsheets are often stored in a single column.</p>
<p>While this seems like a logical way to record dates when you are
entering them, or visually reviewing data, it’s not actually a best
practice for preparing data for analysis.</p>
<p>When working with data, your goal is to have as little ambiguity as
possible. Ambiguity can creep into your data when working with dates
when there are regional variations either in your observations and when
you or your team might be working with different versions or suites of
software products (e.g., LibreOffice, Microsoft Excel, Gnumeric).</p>
<p>To avoid ambiguity between regional differences in date formatting
and compatibility across spreadsheet software programs, a good practice
is to divide dates into components in different columns - DAY, MONTH,
and YEAR.</p>
<p>When working with dates it’s also important to remember that
functions are guaranteed to be compatible only within the same family of
software products (e.g., LibreOffice, Microsoft Excel, Gnumeric). If you
need to export your data and conserve the timestamps, you are better off
handling dates using one of the solutions discussed below than the
single column method.</p>
<p>One of the other reasons dates can be tricky is that most spreadsheet
programs have “useful features” which can change the way dates are
displayed - but not stored. The image below demonstrates some of the
many date formatting options in Excel.</p>
<figure><img src="../fig/excel_dates_1.jpg" alt="Many formats, many ambiguities" class="figure mx-auto d-block"></figure></section><section id="dates-stored-as-integers"><h2 class="section-heading">Dates stored as integers<a class="anchor" aria-label="anchor" href="#dates-stored-as-integers"></a>
</h2>
<hr class="half-width">
<p>The first thing you need to know is that Excel stores dates as
numbers - see the last column in the above figure. This serial number
represents the number of days from December 31, 1899. In the example,
July 2, 2014 is stored as the serial number 41822.</p>
<div id="excels-date-systems" class="callout callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="excels-date-systems" class="callout-inner">
<h3 class="callout-title">Excel’s date systems<a class="anchor" aria-label="anchor" href="#excels-date-systems"></a>
</h3>
<div class="callout-content">
<p>Excel also entertains a second date system, the 1904 date system, as
the default in Excel for Macintosh. This system will assign a different
serial number than the <a href="https://support.microsoft.com/en-us/help/214330/differences-between-the-1900-and-the-1904-date-system-in-excel" class="external-link">1900
date system</a>. Because of this, <a href="https://uc3.cdlib.org/2014/04/09/abandon-all-hope-ye-who-enter-dates-in-excel/" class="external-link">dates
must be checked for accuracy when exporting data from Excel</a> (look
for dates that are ~4 years off).</p>
</div>
</div>
</div>
<p>Using functions we can add days, months or years to a given date. Say
you had a research plan where you needed to conduct interviews with a
set of informants every ninety days for a year.</p>
<p>In our example above, in a new cell you can type:</p>
<p>=B2+90</p>
<p>And it would return</p>
<p>30-Sep</p>
<p>because it understands the date as a number <code>41822</code>, and
<code>41822 + 90 = 41912</code> which Excel interprets as the 30th day
of September, 2014. In most cases, it retains the format of the cell
that is being operated upon. Month and year rollovers are internally
tracked and applied.</p>
</section><section id="regional-date-formatting"><h2 class="section-heading">Regional date formatting<a class="anchor" aria-label="anchor" href="#regional-date-formatting"></a>
</h2>
<hr class="half-width">
<p>When you enter a date into a spreadsheet it looks like a date
although the spreadsheet program may display different text from what
you input. It does this to be ‘helpful’ but it often is not.</p>
<p>For example if you enter ‘7/12/88’ into your Excel spreadsheet it may
display as ‘07/12/1988’ (depending on your version of Excel). These are
different ways of formatting the same date.</p>
<p>Different countries also write dates differently. If you are in the
UK, for example, you will interpret the date above as the 7th day of
December, however a researcher from the US will interpret the same entry
as the 12th day of July. This regional variation is handled
automatically by your spreadsheet program so that when you are typing in
dates they appear as you would expect. If you try to type in a US format
date into a UK version of Excel, it may or may not be treated as a
date.</p>
<p>This regional variation is one good reason to treat dates, not as a
single data point, but as three distinct pieces of data (month, day, and
year). Separating dates into their component parts will avoid this
confusion, while also giving the added benefit of allowing you to
compare, for example data collected in January of multiple years with
data collected in February of multiple years.</p>
<div id="separating-dates-into-components" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="separating-dates-into-components" class="callout-inner">
<h3 class="callout-title">Separating dates into components<a class="anchor" aria-label="anchor" href="#separating-dates-into-components"></a>
</h3>
<div class="callout-content">
<p>Download and open the <a href="https://ndownloader.figshare.com/files/11502827" class="external-link">SAFI_dates.xlsx</a>
file. This file contains a subset of the data from the SAFI interviews,
including the dates on which the interviews were conducted.</p>
<p>Choose the tab of the spreadsheet that corresponds to the way you
format dates in your location (either day first <code>DD_MM_YEAR</code>,
or month first <code>MM_DD_YEAR</code>).</p>
<p>Extract the components of the date to new columns. For this we can
use the built in Excel functions:</p>
<p><code>=MONTH()</code><br><code>=DAY()</code><br><code>=YEAR()</code></p>
<p>Apply each of these formulas to its entire column. Make sure the new
column is formatted as a number and not as a date.</p>
<p>We now have each component of our date isolated in its own column.
This will allow us to group our data with respect to month, year, or day
of month for our analyses and will also prevent problems when passing
data between different versions of spreadsheet software (as for example
when sharing data with collaborators in different countries).</p>
</div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1">Show me the solution</h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" data-bs-parent="#accordionSolution1" aria-labelledby="headingSolution1">
<div class="accordion-body">
<figure><img src="../fig/solution_exercise_1_dates.png" alt="dates exercise 1" class="figure mx-auto d-block"></figure><p>Note that this solution shows the dates in <code>MM_DD_YEAR</code>
format.</p>
</div>
</div>
</div>
</div>
<div id="default-year" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="default-year" class="callout-inner">
<h3 class="callout-title">Default year<a class="anchor" aria-label="anchor" href="#default-year"></a>
</h3>
<div class="callout-content">
<p>Using the same spreadsheet you used for the previous exercise, add
another data point in the <code>interview_date</code> column by typing
either <code>11/17</code> (if your location uses <code>MM/DD</code>
formatting) or <code>17/11</code> (if your location uses
<code>DD/MM</code> formatting). The <code>Day</code>,
<code>Month</code>, and <code>Year</code> columns should populate for
this new data point. What year is shown in the <code>Year</code>
column?</p>
</div>
</div>
</div>
<div id="accordionSolution2" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution2" aria-expanded="false" aria-controls="collapseSolution2">
  <h4 class="accordion-header" id="headingSolution2">Show me the solution</h4>
</button>
<div id="collapseSolution2" class="accordion-collapse collapse" data-bs-parent="#accordionSolution2" aria-labelledby="headingSolution2">
<div class="accordion-body">
<p>If no year is specified, the spreadsheet program will assume you mean
the current year and will insert that value. This may be incorrect if
you are working with historical data so be very cautious when working
with data that does not have a year specified within its date
variable.</p>
</div>
</div>
</div>
</div>
</section><section id="historical-data"><h2 class="section-heading">Historical data<a class="anchor" aria-label="anchor" href="#historical-data"></a>
</h2>
<hr class="half-width">
<p>Excel is unable to parse dates from before 1899-12-31, and will thus
leave these untouched. If you’re mixing historic data from before and
after this date, Excel will translate only the post-1900 dates into its
internal format, thus resulting in mixed data. If you’re working with
historic data, be extremely careful with your dates!</p>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Key Points<a class="anchor" aria-label="anchor" href="#keypoints1"></a>
</h3>
<div class="callout-content">
<ul>
<li>Use extreme caution when working with date data.</li>
<li>Splitting dates into their component values can make them easier to
handle.</li>
</ul>
</div>
</div>
</div>
</section></section><section id="aio-04-quality-assurance"><p>Content from <a href="04-quality-assurance.html">Quality Assurance</a></p>
<hr>
<p>Last updated on 2023-05-03 |
        
        <a href="https://github.com/fishtree-attempt/spreadsheets-socialsci/edit/main/episodes/04-quality-assurance.md" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<p>Estimated time: <i aria-hidden="true" data-feather="clock"></i> 25 minutes</p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>How can we carry out basic quality assurance in spreadsheets?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Apply quality assurance techniques to limit incorrect data
entry.</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<p>When you have a well-structured data table, you can use several
simple techniques within your spreadsheet to ensure the data you enter
is free of errors.</p>
<section id="validating-data-on-input"><h2 class="section-heading">Validating data on input<a class="anchor" aria-label="anchor" href="#validating-data-on-input"></a>
</h2>
<hr class="half-width">
<p>When we input data into a cell of a spreadsheet we are typically not
constrained in the type of data we enter. In any one column, the
spreadsheets software will not warn us if we start to enter a mix of
text, numbers or dates in different rows. Even if we are not facing
constraints from the software, as a researcher we often anticipate that
all data in one column will be of a certain type. It is also possible
that the nature of the data contained in the table allows us to place
additional restrictions on the acceptable values for cells in a column.
For example a column recording age in years should be numeric, greater
than 0 and is unlikely to be greater than 120.</p>
<p>Excel allows us to specify a variety of data validations to be
applied to cell contents. If the validation fails, an error is raised
and the data we entered does not go into the particular cell. In
addition to providing validation when we enter data, Excel allows us to
add validations to data that has already been entered. The validation is
not applied retrospectively, so that data are removed. Instead, if a
particular cell would fail the validation check a triangle is placed in
the top left corner of the cell as a warning.</p>
<p>We will be working with a couple of examples of data validation rules
but many others exist. For an overview of data validation rules
available in Excel, check out the <a href="https://support.office.com/en-us/article/Apply-data-validation-to-cells-29FECBCC-D1B9-42C1-9D76-EFF3CE5F7249" class="external-link">Excel
support page on data validation</a>.</p>
<p>We will look at two examples:</p>
<ol style="list-style-type: decimal">
<li>Restricting data to a numeric range</li>
<li>Restricting data to entries from a list</li>
</ol>
<div class="section level3">
<h3 id="restricting-data-to-a-numeric-range">Restricting data to a numeric range<a class="anchor" aria-label="anchor" href="#restricting-data-to-a-numeric-range"></a>
</h3>
<p>Looking again at the <a href="https://ndownloader.figshare.com/files/11492171" class="external-link">clean version of
the SAFI dataset</a>, we see that there are several columns with numeric
data. One example of this is the column <code>no_membrs</code>
representing the number of people in the household. We would expect this
always to be a positive integer, and so we should reject values like
<code>1.5</code> and <code>-8</code> as entry errors. We would also
reject values over a certain maximum - for example an entry like
<code>90</code> is probably the result of the researcher inputting
<code>9</code> and their finger slipping and also hitting the
<code>0</code> key. It is up to you as the researcher to decide what a
reasonable maximum value would be for your data, here we will assume
that there are no families with greater than 30 members.</p>
<p>1. Select the <code>no_membrs</code> column.</p>
<p>2. In Excel on the <code>Data</code> tab select
<code>Data Tools</code> and then <code>Data Validation</code> or
<code>Validation Tools</code> (depending on your version of Excel). The
following popout will appear:</p>
<figure><img src="../fig/data-validation-tab.png" alt="Image of data validation tab in Excel" class="figure mx-auto d-block"></figure><p>In Libre Office on the <code>Data</code> tab select
<code>Validity...</code> the following popup will appear:</p>
<figure><img src="../fig/data-validation-tab-LibreOffice.png" alt="Image of data validation tab in LibreOffice" class="figure mx-auto d-block"></figure><p>3. In Excel, select ‘Whole number’ from the <code>Allow</code> drop
down options.</p>
<p>In Libre Office choose <code>Allow: Whole Numbers</code> and then
<code>Data: valid range</code>.</p>
<p>4. The window content will change. The value in the data box will say
‘between’ and <code>Minimum</code> and <code>Maximum</code> boxes will
be provided for you to specify an allowed range. In Excel you will
see:</p>
<figure><img src="../fig/data-validation-numbers.png" alt="Image of data validation tab for number rules in Excel" class="figure mx-auto d-block"></figure><p>In LibreOffice, you will see:</p>
<figure><img src="../fig/data-validation-numbers-LibreOffice.png" alt="Image of data validation tab in LibreOffice" class="figure mx-auto d-block"></figure><p>5. Fill in the minimum and maximum values that make sense for your
data and click <code>Ok</code>. Here we will choose a minimum of 1 and a
maximum of 30.</p>
<p>Your data table will now not allow you to enter a value that violates
the data validation rule you have created. To test this out, try to
enter a new value into the <code>no_membrs</code> column that is not
valid. The following error box will appear in Excel:</p>
<figure><img src="../fig/error-invalid-data.png" alt="Image of error message for inputing invalid data in Excel" class="figure mx-auto d-block"></figure><p>The following error box will appear in LibreOffice:</p>
<figure><img src="../fig/error-invalid-data-LibreOffice.png" alt="Image of error message for inputing invalid data in LibreOffice" class="figure mx-auto d-block"></figure><p>You can also customize the resulting message to be more informative
by entering your own message in the <code>Input Message</code> tab when
creating a data validation rule. In Excel, you will see:</p>
<figure><img src="../fig/input_message.png" alt="Image of Input Message tab in Excel" class="figure mx-auto d-block"></figure><p>In LibreOffice, you will see:</p>
<figure><img src="../fig/input_message_LibreOffice.png" alt="Image of Input Message tab in LibreOffice" class="figure mx-auto d-block"></figure><p>You can also allow invalid data to result in a warning rather than an
error by modifying the <code>Style</code> option on the
<code>Error Alert</code> tab. For Excel you will see:</p>
<figure><img src="../fig/error_alert.png" alt="Image of Error Alert tab in Excel" class="figure mx-auto d-block"></figure><p>In LibreOffice, you will see:</p>
<figure><img src="../fig/error_alert_LibreOffice.png" alt="Image of Error Alert tab in LibreOffice" class="figure mx-auto d-block"></figure><div id="exercise" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="exercise" class="callout-inner">
<h3 class="callout-title">Exercise<a class="anchor" aria-label="anchor" href="#exercise"></a>
</h3>
<div class="callout-content">
<p>Apply a new data validation rule to one of the other numeric columns
in this data table. Discuss with the person sitting next to you what a
reasonable rule would be for the column you’ve selected. Be sure to
create an informative input message.</p>
</div>
</div>
</div>
</div>
<div class="section level3">
<h3 id="restricting-data-to-entries-from-a-list">Restricting data to entries from a list<a class="anchor" aria-label="anchor" href="#restricting-data-to-entries-from-a-list"></a>
</h3>
<p>Quality assurance can make data entry easier as well as more robust.
For example, if you use a list of options to restrict data entry, the
spreadsheet will provide you with a drop-downlist of the available
items. So, instead of trying to remember how to spell “mabatisloping”,
or whether or not you capitalized “cement” you can select the right
option from the list.</p>
<p>1. Select the <code>respondent_wall_type</code> column.</p>
<p>2. In Excel, on the <code>Data</code> tab select
<code>Data Tools</code> and then <code>Data Validation</code> or
<code>Validation Tools</code> (depending on your version of Excel). The
following popout will appear:</p>
<figure><img src="../fig/data-validation-tab.png" alt="Image of data validation tab in Excel" class="figure mx-auto d-block"></figure><p>In LibreOffice, on the <code>Data</code> tab select
<code>Validity...</code></p>
<figure><img src="../fig/data-validation-tab-LibreOffice.png" alt="Image of data validation tab in Excel" class="figure mx-auto d-block"></figure><p>3. In Excel, select <code>List</code> from the <code>Allow</code>
drop-down menu, and in LibreOffice, choose the <code>List</code>
option.</p>
<p>4. In Excel, the window will change to include a <code>Source</code>
box, you will see,</p>
<figure><img src="../fig/select-range-of-values.png" alt="Image of selecting a range of values to allow in Excel" class="figure mx-auto d-block"></figure><p>In LibreOffice, you will see,</p>
<figure><img src="../fig/select-range-of-values-LibreOffice.png" alt="Image of selecting a range of values to allow in LibreOffice" class="figure mx-auto d-block"></figure><p>5. Type a list of all the values that you want to be accepted in this
column, separated by a comma (with no spaces). For us this will be
“grass, muddaub, burntbricks, sunbricks, cement”.</p>
<p>In LibreOffice, your entries of grass, muddaub, burntbricks,
sunbricks and cement should be on new lines as shown below</p>
<figure><img src="../fig/filled-range-of-values-LibreOffice.png" alt="Image of filled in range of values to allow in LibreOffice" class="figure mx-auto d-block"></figure><p>6. In Excel, create a meaningful input message, then click OK. In
LibreOffice, there is no need to create an input message.</p>
<p>We have now provided a restriction that will be validated each time
we try and enter data into the selected cells. When a cell in this
column is selected, a drop-down arrow will appear. When you click the
arrow, you will be able to select a value from your list. If you type a
value which is not on the list, you will get an error message. This not
only prevents data input errors, but also makes it easier and faster to
enter data.</p>
<div id="exercise-1" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="exercise-1" class="callout-inner">
<h3 class="callout-title">Exercise<a class="anchor" aria-label="anchor" href="#exercise-1"></a>
</h3>
<div class="callout-content">
<p>Apply a new data validation rule to one of the other categorical
columns in this data table. Discuss with the person sitting next to you
what a reasonable rule would be for the column you’ve selected. Be sure
to create an informative input message.</p>
</div>
</div>
</div>
<div id="tip" class="callout callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="tip" class="callout-inner">
<h3 class="callout-title">Tip<a class="anchor" aria-label="anchor" href="#tip"></a>
</h3>
<div class="callout-content">
<p>Typing a list of values where only a few possible values exist (like
“grass, muddaub, burntbricks, sunbricks, cement”) might be convenient,
but if the list is longer it makes sense to create it as a small table
(in a separate tab of the workbook). We can give the table a name and
then reference the table name as the source of acceptable inputs when
the source box appears in the Data Validation pop-out.</p>
<p>Using a table in this way makes the data entry process more flexible.
If you add or remove contents from the table, then these are immediately
reflected in any new cell entries based on this source. You can also
have different cells refer to the same table of acceptable inputs.</p>
</div>
</div>
</div>
<div id="tip-1" class="callout callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="tip-1" class="callout-inner">
<h3 class="callout-title">Tip<a class="anchor" aria-label="anchor" href="#tip-1"></a>
</h3>
<div class="callout-content">
<p>In the examples above we have applied data validation rules to an
existing spreadsheet to demonstrate how they work, however, you may have
noticed that data validation rules are not applied retroactively to data
that is already present in the cell. This means, for example, that if we
had already entered <code>150</code> in the <code>no_membrs</code>
column before applying our data validation rule, that cell would not be
flagged with a warning.</p>
<p>In some versions of Excel, you can click in the <code>Data</code> tab
on <code>Data Validation</code> and then
<code>Circle invalid data</code>. This will put red circles around
invalid data entries. Note that it can be a bit slow with large data
files.</p>
<p>When using spreadsheets for data entry, it is a good idea to set up
data validation rules for each column when you set up your spreadsheet
(i.e. before you enter any data).</p>
</div>
</div>
</div>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Key Points<a class="anchor" aria-label="anchor" href="#keypoints1"></a>
</h3>
<div class="callout-content">
<ul>
<li>Always copy your original spreadsheet file and work with a copy so
you don’t affect the raw data.</li>
<li>Use data validation to prevent accidentally entering invalid
data.</li>
</ul>
</div>
</div>
</div>
</div>
</section></section><section id="aio-05-exporting-data"><p>Content from <a href="05-exporting-data.html">Exporting Data</a></p>
<hr>
<p>Last updated on 2023-05-03 |
        
        <a href="https://github.com/fishtree-attempt/spreadsheets-socialsci/edit/main/episodes/05-exporting-data.md" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<p>Estimated time: <i aria-hidden="true" data-feather="clock"></i> 15 minutes</p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>How can we export data from spreadsheets in a way that is useful for
downstream applications?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Store spreadsheet data in universal file formats.</li>
<li>Export data from a spreadsheet to a CSV file.</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<p>Storing the data you’re going to work with for your analyses in Excel
default file format (<code>*.xls</code> or <code>*.xlsx</code> -
depending on the Excel version) isn’t a good idea. Why?</p>
<ul>
<li><p>Because it is a proprietary format, and it is possible that in
the future, technology won’t exist (or will become sufficiently rare) to
make it inconvenient, if not impossible, to open the file.</p></li>
<li><p>Other spreadsheet software may not be able to open files saved in
a proprietary Excel format.</p></li>
<li><p>Different versions of Excel may handle data differently, leading
to inconsistencies.</p></li>
<li><p>Finally, more journals and grant agencies are requiring you to
deposit your data in a data repository, and most of them don’t accept
Excel format. It needs to be in one of the formats discussed
below.</p></li>
<li><p>The above points also apply to other formats such as open data
formats used by LibreOffice. These formats are not static and do not get
parsed the same way by different software packages.</p></li>
</ul>
<p>As an example of inconsistencies in data storage, do you remember how
we talked about how Excel stores dates earlier? It turns out that there
are multiple defaults for different versions of the software, and you
can switch between them all. So, say you’re compiling Excel-stored data
from multiple sources. There’s dates in each file- Excel interprets them
as their own internally consistent serial numbers. When you combine the
data, Excel will take the serial number from the place you’re importing
it from, and interpret it using the rule set for the version of Excel
you’re using. Essentially, you could be adding errors to your data, and
it wouldn’t necessarily be flagged by any data cleaning methods if your
ranges overlap.</p>
<p>Storing data in a universal, open, and static format will help deal
with this problem. Try tab-delimited (tab separated values or TSV) or
comma-delimited (comma separated values or CSV). CSV files are plain
text files where the columns are separated by commas, hence ‘comma
separated values’ or CSV. The advantage of a CSV file over an
Excel/SPSS/etc. file is that we can open and read a CSV file using just
about any software, including plain text editors like TextEdit or
NotePad. Data in a CSV file can also be easily imported into other
formats and environments, such as SQLite and R. We’re not tied to a
certain version of a certain expensive program when we work with CSV
files, so it’s a good format to work with for maximum portability and
endurance. Most spreadsheet programs can save to delimited text formats
like CSV easily, although they may give you a warning during the file
export.</p>
<p>To save a file you have opened in Excel in CSV format:</p>
<ol style="list-style-type: decimal">
<li>From the top menu select <code>File</code> and
<code>Save as</code>.</li>
<li>In the <code>Format</code> field, from the list, select
<code>Comma Separated Values</code> (<code>*.csv</code>).</li>
<li>Double check the file name and the location where you want to save
it and hit <code>Save</code>.</li>
</ol>
<p>An important note for backwards compatibility: you can open CSV files
in Excel!</p>
<figure><img src="../fig/excel-to-csv.png" alt="Saving an Excel file to CSV" class="figure mx-auto d-block"></figure><div id="a-note-on-r-and-xls" class="callout callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="a-note-on-r-and-xls" class="callout-inner">
<h3 class="callout-title">A note on R and<code>xls</code><a class="anchor" aria-label="anchor" href="#a-note-on-r-and-xls"></a>
</h3>
<div class="callout-content">
<p>There are R packages that can read <code>xls</code> files (as well as
Google spreadsheets). It is even possible to access different worksheets
in the <code>xls</code> documents. However, because these packages parse
data tables from proprietary and non-static software, there is no
guarantee that they will continue to work on new versions of Excel.
Exporting your data to CSV or TSV format is much safer and more
reproducible.</p>
</div>
</div>
</div>
<div id="what-to-do-when-your-data-contain-commas" class="callout callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="what-to-do-when-your-data-contain-commas" class="callout-inner">
<h3 class="callout-title">What to do when your data contain commas<a class="anchor" aria-label="anchor" href="#what-to-do-when-your-data-contain-commas"></a>
</h3>
<div class="callout-content">
<p>In some datasets, the data values themselves may include commas (,).
In that case, you need to make sure that the commas are properly escaped
when saving the file. Otherwise, the software which you use (including
Excel) will most likely incorrectly display the data in columns. This is
because the commas which are a part of the data values will be
interpreted as delimiters.</p>
<p>If you are working with data that contains commas, the fields should
be enclosed with double quotes. The spreadsheet software should do the
right thing (<a href="https://www.libreoffice.org/download/download/" class="external-link">LibreOffice</a>
provides comprehensive options to import and export CSV files). However,
it is always a good idea to double check that the file you are exporting
can be read in correctly. For more of a discussion on data formats and
potential issues with commas within datasets see <a href="https://www.datacarpentry.org/spreadsheet-ecology-lesson/discuss/" class="external-link">the
Ecology Spreadsheets lesson discussion page</a>.</p>
</div>
</div>
</div>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Key Points<a class="anchor" aria-label="anchor" href="#keypoints1"></a>
</h3>
<div class="callout-content">
<ul>
<li>Data stored in common spreadsheet formats will often not be read
correctly into data analysis software, introducing errors into your
data.</li>
<li>Exporting data from spreadsheets to formats like CSV or TSV puts it
in a format that can be used consistently by most programs.</li>
</ul>
</div>
</div>
</div></section>
</div>
    </main>
</div>
<!-- END  : inst/pkgdown/templates/content-extra.html -->

      </div>
<!--/div.row-->
      		<footer class="row footer mx-md-3"><hr>
<div class="col-md-6">
        <p>This lesson is subject to the <a href="CODE_OF_CONDUCT.html">Code of Conduct</a></p>
        <p>
        
        <a href="https://github.com/fishtree-attempt/spreadsheets-socialsci/edit/main/README.md" class="external-link">Edit on GitHub</a>
        
	
        | <a href="https://github.com/fishtree-attempt/spreadsheets-socialsci/blob/main/CONTRIBUTING.md" class="external-link">Contributing</a>
        | <a href="https://github.com/fishtree-attempt/spreadsheets-socialsci/" class="external-link">Source</a></p>
				<p><a href="https://github.com/fishtree-attempt/spreadsheets-socialsci/blob/main/CITATION" class="external-link">Cite</a> | <a href="mailto:team@carpentries.org">Contact</a> | <a href="https://carpentries.org/about/" class="external-link">About</a></p>
			</div>
			<div class="col-md-6">
        
        <p>Materials licensed under <a href="LICENSE.html">CC-BY 4.0</a> by the authors</p>
        
        <p>Template licensed under <a href="https://creativecommons.org/licenses/by-sa/4.0/" class="external-link">CC-BY 4.0</a> by <a href="https://carpentries.org/" class="external-link">The Carpentries</a></p>
        <p>Built with <a href="https://github.com/carpentries/sandpaper/tree/0.16.2" class="external-link">sandpaper (0.16.2)</a>, <a href="https://github.com/carpentries/pegboard/tree/0.7.3" class="external-link">pegboard (0.7.3)</a>, and <a href="https://github.com/carpentries/varnish/tree/1.0.1" class="external-link">varnish (1.0.1)</a></p>
			</div>
		</footer>
</div> <!-- / div.container -->
	<div id="to-top">
		<a href="#top">
      <i class="search-icon" data-feather="arrow-up" role="img" aria-label="Back To Top"></i><br><!-- <span class="d-none d-sm-none d-md-none d-lg-none d-xl-block">Back</span> To Top --><span class="d-none d-sm-none d-md-none d-lg-none d-xl-block">Back</span> To Top
		</a>
	</div>
  <script type="application/ld+json">
    {
  "@context": "https://schema.org",
  "@type": "TrainingMaterial",
  "@id": "https://preview.carpentries.org/spreadsheets-socialsci/instructor/aio.html",
  "inLanguage": "en",
  "dct:conformsTo": "https://bioschemas.org/profiles/TrainingMaterial/1.0-RELEASE",
  "description": "A Carpentries Lesson teaching foundational data and coding skills to researchers worldwide",
  "keywords": "software, data, lesson, The Carpentries",
  "name": "All in One View",
  "creativeWorkStatus": "active",
  "url": "https://preview.carpentries.org/spreadsheets-socialsci/instructor/aio.html",
  "identifier": "https://preview.carpentries.org/spreadsheets-socialsci/instructor/aio.html",
  "dateCreated": "2023-05-03",
  "dateModified": "2024-01-16",
  "datePublished": "2024-01-16"
}

  </script><script>
		feather.replace();
	</script><!-- Matomo
    2022-11-07: we have gotten a notification that we have an overage for our
    tracking and I'm pretty sure this has to do with Workbench usage.
    Considering that I am not _currently_ using this tracking because I do not
    yet know how to access the data, I am turning this off for now.
  <script>
    var _paq = window._paq = window._paq || [];
    /* tracker methods like "setCustomDimension" should be called before "trackPageView" */
    _paq.push(["setDocumentTitle", document.domain + "/" + document.title]);
    _paq.push(["setDomains", ["*.preview.carpentries.org","*.datacarpentry.github.io","*.datacarpentry.org","*.librarycarpentry.github.io","*.librarycarpentry.org","*.swcarpentry.github.io", "*.carpentries.github.io"]]);
    _paq.push(["setDoNotTrack", true]);
    _paq.push(["disableCookies"]);
    _paq.push(['trackPageView']);
    _paq.push(['enableLinkTracking']);
    (function() {
          var u="https://carpentries.matomo.cloud/";
          _paq.push(['setTrackerUrl', u+'matomo.php']);
          _paq.push(['setSiteId', '1']);
          var d=document, g=d.createElement('script'), s=d.getElementsByTagName('script')[0];
          g.async=true; g.src='https://cdn.matomo.cloud/carpentries.matomo.cloud/matomo.js'; s.parentNode.insertBefore(g,s);
        })();
  </script>
  End Matomo Code -->
</body>
</html><!-- END:   inst/pkgdown/templates/layout.html-->

